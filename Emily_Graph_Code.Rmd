---
title: "Emily's Plots"
author: "Emily Bergin"
date: "4/19/2022"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(dplyr)
library(lubridate)
library(ggthemes)
library(readr)
```

```{r}
Data2016 <- read_csv("2016FullPitchData.csv", 
    col_types = cols(player_id = col_number(), 
        year = col_number(), player_age = col_number(), 
        p_game = col_number(), p_formatted_ip = col_number(), 
        p_strikeout = col_number(), p_k_percent = col_number(), 
        p_era = col_number(), n = col_number(), 
        n_ff_formatted = col_number(), ff_avg_speed = col_number(), 
        ff_avg_spin = col_number(), ff_avg_break_x = col_number(), 
        ff_avg_break_z = col_number(), ff_avg_break = col_number(), 
        ff_range_speed = col_number(), n_sl_formatted = col_number(), 
        sl_avg_speed = col_number(), sl_avg_spin = col_number(), 
        sl_avg_break_x = col_number(), sl_avg_break_z = col_number(), 
        sl_avg_break = col_number(), sl_range_speed = col_number(), 
        n_ch_formatted = col_number(), ch_avg_speed = col_number(), 
        ch_avg_spin = col_number(), ch_avg_break_x = col_number(), 
        ch_avg_break_z = col_number(), ch_avg_break = col_number(), 
        ch_range_speed = col_number(), n_cukc_formatted = col_number(), 
        cu_avg_speed = col_number(), cu_avg_spin = col_number(), 
        cu_avg_break_x = col_number(), cu_avg_break_z = col_number(), 
        cu_avg_break = col_number(), cu_range_speed = col_number(), 
        n_sift_formatted = col_number(), 
        si_avg_speed = col_number(), si_avg_spin = col_number(), 
        si_avg_break_x = col_number(), si_avg_break_z = col_number(), 
        si_avg_break = col_number(), si_range_speed = col_number(), 
        n_fc_formatted = col_number(), fc_avg_speed = col_number(), 
        fc_avg_spin = col_number(), fc_avg_break_x = col_number(),
        fc_avg_break_z = col_number(), fc_avg_break = col_number(),
        fc_range_speed = col_number(), n_fs_formatted = col_number(),
        fs_avg_speed = col_number(), fs_avg_break_x = col_number(),
        fs_avg_break_z = col_number(), fs_avg_break = col_number(),
        fs_range_speed = col_number(), n_kn_formatted = col_number(),
        kn_avg_speed = col_number(), kn_avg_break_x = col_number(),
        kn_avg_break_z = col_number(), kn_avg_break = col_number(),
        kn_range_speed = col_number()), skip = 1)


```

```{r}
PlayerData <- Data2016 %>%
  select(c(1:12))

FFData2016 <- Data2016 %>%
  select(c(1:12), contains("ff")) %>%
  add_column(Pitch_Type = "FourSeam") %>%
  mutate(pitch_frequency = n_ff_formatted, 
         avg_speed = ff_avg_speed, 
         avg_spin = ff_avg_spin, 
         avg_break_x = ff_avg_break_x, 
         avg_break_z = ff_avg_break_z, 
         avg_break = ff_avg_break, 
         range_speed = ff_range_speed) %>%
  select(-contains("ff"))

SliderData2016 <- Data2016 %>%
  select(c(1:12), contains("sl")) %>%
  add_column(Pitch_Type = "Slider") %>%
  mutate(pitch_frequency = n_sl_formatted, 
         avg_speed = sl_avg_speed, 
         avg_spin = sl_avg_spin, 
         avg_break_x = sl_avg_break_x, 
         avg_break_z = sl_avg_break_z, 
         avg_break = sl_avg_break, 
         range_speed = sl_range_speed) %>%
  select(-contains("sl"))

TidyPitchData <- bind_rows(FFData2016, SliderData2016)
```


```{r}
Data2016 %>%
  ggplot() %>%
  geom_col(x = pitch_freqeuncy, y = pitch_type) +
  geom_text(aes(label = pitch_type), vjust = -0.5, size = 2, color = "black")
```


